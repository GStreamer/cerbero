From f6978f3c12be496f67620f1f2f885994ab1c1c29 Mon Sep 17 00:00:00 2001
From: Tjitte <tjitte@zeppit.com>
Date: Tue, 23 Dec 2025 22:41:25 +0100
Subject: default dcomp off as per
 https://github.com/msys2/MINGW-packages/tree/master/mingw-w64-gtk4

---
 gdk/win32/gdkdisplay-win32.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/gdk/win32/gdkdisplay-win32.c b/gdk/win32/gdkdisplay-win32.c
index 3aeceb55e8..ab52517f06 100644
--- a/gdk/win32/gdkdisplay-win32.c
+++ b/gdk/win32/gdkdisplay-win32.c
@@ -517,7 +517,7 @@ gdk_win32_display_init_dcomp (GdkWin32Display *self)
   const GUID my_IID_IDCompositionDevice = { 0xC37EA93A,0xE7AA,0x450D,0xB1,0x6F,0x97,0x46,0xCB,0x04,0x07,0xF3 };
   IDXGIDevice *dxgi_device;
 
-  if (!gdk_has_feature (GDK_FEATURE_DCOMP))
+  if (!gdk_has_feature (GDK_FEATURE_DCOMP) || g_getenv ("GDK_WIN32_FORCE_DCOMP") == NULL)
     return;
   
   hr_warn (ID3D11Device_QueryInterface (self->d3d11_device, &IID_IDXGIDevice, (void **) &dxgi_device));
-- 
2.50.1 (Apple Git-155)

